<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Profile - SoulConnect</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="./css/qrcode.css">
</head>
<body>
    <div class="container">
        <!-- QR Code Modal -->
        <div class="modal-overlay" id="qrModal">
            <div class="qr-modal">
                <button class="modal-close" id="closeQrModal">
                    <i class="fas fa-times"></i>
                </button>
                
                <div class="qr-header">
                    <h2 class="qr-title">Your Profile QR Code</h2>
                    <p class="qr-description">Scan this code to quickly share your profile</p>
                </div>

                <div class="qr-code-container">
                    <div class="qr-code">
                        <div class="qr-pattern"></div>
                        <div class="qr-avatar">
                            <img src="https://randomuser.me/api/portraits/men/32.jpg" alt="Profile Avatar">
                        </div>
                    </div>
                </div>

                <div class="qr-info">
                    <div class="qr-name">Alex Johnson</div>
                    <div class="qr-username">@alexjohnson</div>
                </div>

                <div class="qr-share-options">
                    <div class="share-title">Share via</div>
                    <div class="share-buttons">
                        <button class="share-btn share-whatsapp" title="Share on WhatsApp">
                            <i class="fab fa-whatsapp"></i>
                        </button>
                        <button class="share-btn share-messenger" title="Share on Messenger">
                            <i class="fab fa-facebook-messenger"></i>
                        </button>
                        <button class="share-btn share-instagram" title="Share on Instagram">
                            <i class="fab fa-instagram"></i>
                        </button>
                        <button class="share-btn share-copy" title="Copy Link" id="copyQrLink">
                            <i class="fas fa-link"></i>
                        </button>
                    </div>
                </div>

                <div class="qr-actions">
                    <button class="btn btn-secondary" id="downloadQr">
                        <i class="fas fa-download"></i> Download QR
                    </button>
                    <button class="btn btn-primary" id="shareProfile">
                        <i class="fas fa-share-alt"></i> Share Profile
                    </button>
                </div>
            </div>
        </div>

        <!-- Scanner Modal -->
        <div class="modal-overlay" id="scannerModal">
            <div class="scanner-modal">
                <button class="modal-close" id="closeScannerModal">
                    <i class="fas fa-times"></i>
                </button>
                
                <div class="qr-header">
                    <h2 class="qr-title">Scan QR Code</h2>
                    <p class="qr-description">Scan a SoulConnect profile QR code</p>
                </div>

                <div class="scanner-tabs">
                    <button class="scanner-tab active" data-tab="camera">Camera</button>
                    <button class="scanner-tab" data-tab="upload">Upload Image</button>
                </div>

                <div class="scanner-container" id="scannerContainer">
                    <div class="scanner-overlay"></div>
                    <div class="scanner-placeholder" id="cameraView">
                        <i class="fas fa-camera"></i>
                        <p>Camera access required for scanning</p>
                    </div>
                    <div class="scanner-placeholder" id="uploadView" style="display: none;">
                        <i class="fas fa-cloud-upload-alt"></i>
                        <p>Upload a QR code image to scan</p>
                        <input type="file" id="fileInput" class="file-input" accept="image/*">
                        <button class="btn btn-primary" onclick="document.getElementById('fileInput').click()">
                            <i class="fas fa-upload"></i> Choose Image
                        </button>
                    </div>
                </div>

                <div class="scanner-instructions">
                    Point your camera at a SoulConnect QR code or upload an image containing the code
                </div>

                <div class="scanner-actions">
                    <button class="btn btn-secondary" id="toggleFlash">
                        <i class="fas fa-bolt"></i> Flash
                    </button>
                    <button class="btn btn-primary" id="startScanner">
                        <i class="fas fa-play"></i> Start Scanner
                    </button>
                </div>
            </div>
        </div>

        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-logo">
                    <i class="fas fa-heart"></i>
                    SoulConnect
                </div>
            </div>
            <div class="sidebar-nav">
                <a href="dash.html" class="nav-item">
                    <i class="fas fa-home"></i>
                    Dashboard
                </a>
                <a href="discover.html" class="nav-item">
                    <i class="fas fa-user-friends"></i>
                    Discover
                    <span class="nav-badge">12</span>
                </a>
                <a href="matches.html" class="nav-item">
                    <i class="fas fa-heart"></i>
                    Matches
                    <span class="nav-badge">8</span>
                </a>
                <a href="messages.html" class="nav-item">
                    <i class="fas fa-comments"></i>
                    Messages
                    <span class="nav-badge">5</span>
                </a>
                <a href="notifications.html" class="nav-item">
                    <i class="fas fa-bell"></i>
                    Notifications
                    <span class="nav-badge">15</span>
                </a>
                <a href="profile.html" class="nav-item active">
                    <i class="fas fa-user"></i>
                    My Profile
                </a>
                <a href="settings.html" class="nav-item">
                    <i class="fas fa-cog"></i>
                    Settings
                </a>
                <a href="index.html" class="nav-item">
                    <i class="fas fa-sign-out-alt"></i>
                    Logout
                </a>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Top Bar -->
            <div class="top-bar">
                <div style="display: flex; align-items: center; gap: 20px;">
                    <div class="search-bar">
                        <i class="fas fa-search"></i>
                        <input type="text" placeholder="Search...">
                    </div>
                    <button class="btn btn-secondary" id="openScanner">
                        <i class="fas fa-qrcode"></i> Scan QR
                    </button>
                </div>
                <div class="user-menu">
                    <div class="notification-icon">
                        <i class="fas fa-bell"></i>
                        <span class="notification-badge">15</span>
                    </div>
                    <div class="user-profile">
                        <div class="user-avatar">
                            <img src="https://randomuser.me/api/portraits/men/32.jpg" alt="User Avatar">
                        </div>
                        <div class="user-info">
                            <h4>Alex Johnson</h4>
                            <p>Premium Member</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Profile Section -->
            <div class="profile-section">
                <div class="profile-header">
                    <div class="profile-avatar-container">
                        <div class="profile-avatar">
                            <img src="https://randomuser.me/api/portraits/men/32.jpg" alt="Profile Avatar">
                        </div>
                        <button class="avatar-edit">
                            <i class="fas fa-camera"></i>
                        </button>
                    </div>
                    <div class="profile-info">
                        <h1 class="profile-name">
                            Alex Johnson, 28
                            <span class="verification-badge">
                                <i class="fas fa-check"></i> Verified
                            </span>
                        </h1>
                        <div class="profile-details">
                            <div class="profile-detail">
                                <i class="fas fa-map-marker-alt"></i>
                                <span>New York, NY</span>
                            </div>
                            <div class="profile-detail">
                                <i class="fas fa-heart"></i>
                                <span>Single</span>
                            </div>
                            <div class="profile-detail">
                                <i class="fas fa-briefcase"></i>
                                <span>Photographer</span>
                            </div>
                            <div class="profile-detail">
                                <i class="fas fa-graduation-cap"></i>
                                <span>NYU Alumni</span>
                            </div>
                        </div>
                        <p class="profile-bio">
                            Professional photographer and travel enthusiast. Love capturing moments and exploring new places. 
                            Coffee addict, hiking lover, and always up for an adventure. Looking for meaningful connections 
                            with someone who shares my passion for exploration and creativity.
                        </p>
                        <div class="profile-stats">
                            <div class="profile-stat">
                                <div class="stat-value">89%</div>
                                <div class="stat-label">Profile Complete</div>
                            </div>
                            <div class="profile-stat">
                                <div class="stat-value">156</div>
                                <div class="stat-label">Likes</div>
                            </div>
                            <div class="profile-stat">
                                <div class="stat-value">24</div>
                                <div class="stat-label">Matches</div>
                            </div>
                            <div class="profile-stat">
                                <div class="stat-value">12</div>
                                <div class="stat-label">Photos</div>
                            </div>
                        </div>
                        <div class="profile-actions">
                            <button class="btn btn-primary">
                                <i class="fas fa-edit"></i> Edit Profile
                            </button>
                            <button class="btn btn-secondary" id="shareProfileBtn">
                                <i class="fas fa-share-alt"></i> Share Profile
                            </button>
                            <button class="btn btn-secondary" id="showQrCode">
                                <i class="fas fa-qrcode"></i> My QR Code
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Modal functionality
        const qrModal = document.getElementById('qrModal');
        const scannerModal = document.getElementById('scannerModal');
        const showQrCodeBtn = document.getElementById('showQrCode');
        const openScannerBtn = document.getElementById('openScanner');
        const closeQrModalBtn = document.getElementById('closeQrModal');
        const closeScannerModalBtn = document.getElementById('closeScannerModal');
        const shareProfileBtn = document.getElementById('shareProfileBtn');
        const scannerTabs = document.querySelectorAll('.scanner-tab');
        const cameraView = document.getElementById('cameraView');
        const uploadView = document.getElementById('uploadView');

        // Show QR Code Modal
        function showQrModal() {
            qrModal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        // Show Scanner Modal
        function showScannerModal() {
            scannerModal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        // Hide Modal
        function hideModal(modal) {
            modal.classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        // Event listeners
        showQrCodeBtn.addEventListener('click', showQrModal);
        openScannerBtn.addEventListener('click', showScannerModal);
        shareProfileBtn.addEventListener('click', showQrModal);

        closeQrModalBtn.addEventListener('click', () => hideModal(qrModal));
        closeScannerModalBtn.addEventListener('click', () => hideModal(scannerModal));

        // Close modal when clicking outside
        [qrModal, scannerModal].forEach(modal => {
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    hideModal(modal);
                }
            });
        });

        // Close modal with Escape key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                if (qrModal.classList.contains('active')) hideModal(qrModal);
                if (scannerModal.classList.contains('active')) hideModal(scannerModal);
            }
        });

        // Scanner tabs
        scannerTabs.forEach(tab => {
            tab.addEventListener('click', function() {
                const targetTab = this.getAttribute('data-tab');
                
                // Update active tab
                scannerTabs.forEach(t => t.classList.remove('active'));
                this.classList.add('active');
                
                // Show corresponding view
                if (targetTab === 'camera') {
                    cameraView.style.display = 'block';
                    uploadView.style.display = 'none';
                } else {
                    cameraView.style.display = 'none';
                    uploadView.style.display = 'block';
                }
            });
        });

        // Scanner functionality
        const startScannerBtn = document.getElementById('startScanner');
        const toggleFlashBtn = document.getElementById('toggleFlash');
        const fileInput = document.getElementById('fileInput');

        let scannerActive = false;
        let flashOn = false;

        startScannerBtn.addEventListener('click', function() {
            if (!scannerActive) {
                // Start scanner simulation
                startScannerBtn.innerHTML = '<i class="fas fa-stop"></i> Stop Scanner';
                startScannerBtn.style.background = '#dc3545';
                
                // Simulate scanning process
                setTimeout(() => {
                    // Simulate successful scan
                    const profiles = [
                        { name: "Sarah Miller", username: "@sarahm", age: 26, location: "Los Angeles, CA" },
                        { name: "Mike Chen", username: "@mikec", age: 29, location: "Chicago, IL" },
                        { name: "Emma Davis", username: "@emmad", age: 25, location: "Miami, FL" }
                    ];
                    
                    const randomProfile = profiles[Math.floor(Math.random() * profiles.length)];
                    
                    // Show profile preview
                    if (confirm(`QR Code scanned! Profile found:\n\n${randomProfile.name}, ${randomProfile.age}\n${randomProfile.location}\n\nWould you like to view this profile?`)) {
                        // Redirect to profile (simulated)
                        alert(`Redirecting to ${randomProfile.name}'s profile...`);
                        hideModal(scannerModal);
                        
                        // Reset scanner
                        resetScanner();
                    } else {
                        resetScanner();
                    }
                }, 3000);
                
                scannerActive = true;
            } else {
                resetScanner();
            }
        });

        function resetScanner() {
            startScannerBtn.innerHTML = '<i class="fas fa-play"></i> Start Scanner';
            startScannerBtn.style.background = '';
            scannerActive = false;
        }

        toggleFlashBtn.addEventListener('click', function() {
            flashOn = !flashOn;
            toggleFlashBtn.innerHTML = flashOn ? 
                '<i class="fas fa-bolt"></i> Flash On' : 
                '<i class="fas fa-bolt"></i> Flash';
            toggleFlashBtn.style.background = flashOn ? '#ffc107' : '';
        });

        // File upload for QR code scanning
        fileInput.addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                // Simulate processing uploaded image
                alert('Processing uploaded image for QR code...');
                
                setTimeout(() => {
                    const profiles = [
                        { name: "Jessica Wilson", username: "@jessicaw", age: 27, location: "Seattle, WA" },
                        { name: "David Brown", username: "@davidb", age: 31, location: "Austin, TX" }
                    ];
                    
                    const randomProfile = profiles[Math.floor(Math.random() * profiles.length)];
                    
                    if (confirm(`QR Code found in image!\n\n${randomProfile.name}, ${randomProfile.age}\n${randomProfile.location}\n\nView profile?`)) {
                        alert(`Opening ${randomProfile.name}'s profile...`);
                        hideModal(scannerModal);
                    }
                    
                    // Reset file input
                    fileInput.value = '';
                }, 2000);
            }
        });

        // Existing QR code functionality
        const downloadQrBtn = document.getElementById('downloadQr');
        const shareProfileModalBtn = document.getElementById('shareProfile');
        const copyQrLinkBtn = document.getElementById('copyQrLink');

        downloadQrBtn.addEventListener('click', function() {
            alert('QR code download functionality would be implemented here');
        });

        shareProfileModalBtn.addEventListener('click', function() {
            if (navigator.share) {
                navigator.share({
                    title: 'Alex Johnson - SoulConnect Profile',
                    text: 'Check out my SoulConnect profile!',
                    url: 'https://soulconnect.com/profile/alexjohnson'
                });
            } else {
                alert('Share profile link: https://soulconnect.com/profile/alexjohnson');
            }
        });

        copyQrLinkBtn.addEventListener('click', function() {
            const profileUrl = 'https://soulconnect.com/profile/alexjohnson';
            
            navigator.clipboard.writeText(profileUrl).then(function() {
                const originalHtml = copyQrLinkBtn.innerHTML;
                copyQrLinkBtn.innerHTML = '<i class="fas fa-check"></i>';
                copyQrLinkBtn.style.background = 'var(--success)';
                
                setTimeout(() => {
                    copyQrLinkBtn.innerHTML = originalHtml;
                    copyQrLinkBtn.style.background = '';
                }, 2000);
            }).catch(function(err) {
                alert('Failed to copy link to clipboard');
            });
        });

        // Social sharing buttons
        document.querySelectorAll('.share-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const platform = this.classList[1];
                const profileUrl = 'https://soulconnect.com/profile/alexjohnson';
                let shareUrl = '';
                
                switch(platform) {
                    case 'share-whatsapp':
                        shareUrl = `https://wa.me/?text=Check out my SoulConnect profile! ${profileUrl}`;
                        break;
                    case 'share-messenger':
                        shareUrl = `https://www.facebook.com/dialog/send?link=${encodeURIComponent(profileUrl)}&app_id=123456789&redirect_uri=${encodeURIComponent(profileUrl)}`;
                        break;
                    case 'share-instagram':
                        shareUrl = `https://www.instagram.com/`;
                        break;
                    default:
                        return;
                }
                
                if (shareUrl) {
                    window.open(shareUrl, '_blank', 'width=600,height=400');
                }
            });
        });

        // Simple avatar edit functionality
        document.querySelector('.avatar-edit').addEventListener('click', function() {
            alert('Avatar upload functionality would open here');
        });

        // Simple edit profile functionality
        document.querySelector('.btn-primary').addEventListener('click', function() {
            alert('Edit profile page would open here');
        });
    </script>
</body>
</html>